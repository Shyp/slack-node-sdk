// Generated by CoffeeScript 1.6.3
var Slack, request,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

request = require("request");

Slack = (function() {
  function Slack(token, domain) {
    this.token = token;
    this.domain = domain;
    this.post = __bind(this.post, this);
    this.composeUrl = __bind(this.composeUrl, this);
    this.apiMode = !this.domain ? true : false;
  }

  Slack.prototype.composeUrl = function() {
    if (this.apiMode) {
      return "https://" + this.domain + ".slack.com/services/hooks/incoming-webhook?token=" + this.token;
    } else {
      return "https://" + this.domain + ".slack.com/services/hooks/incoming-webhook?token=" + this.token;
    }
  };

  Slack.prototype.post = function(options, callback) {
    var url;
    url = this.composeUrl();
    return request.post({
      url: url,
      body: JSON.stringify({
        channel: options.channel,
        text: options.text,
        username: options.username
      })
    }, function(err, body, response) {
      return callback(err, response);
    });
  };

  return Slack;

})();

module.exports = Slack;
